# CSA07 Skim for HWW Events
# Filter events with double high-pt tracks
# then produces AODSIM selected events
# Created by Ezio Torassa
# Tested on 2007/05/31/

process HWWSkim= {

#    untracked PSet options = {
#	untracked bool wantSummary = true  # default is false
#    }
    
    ### keep the logging output to a nice level ###
     include "FWCore/MessageLogger/data/MessageLogger.cfi"
     include "SimGeneral/HepPDTESSource/data/pythiapdt.cfi"
    
    service = AdaptorConfig {}
    
    source = PoolSource {
	untracked vstring fileNames =
	{
        "file:/data/etorassa/Rereco_HWW_2l2nu_008.root"
	}
	untracked int32 maxEvents = -1
	untracked uint32 debugVerbosity = 0
	untracked bool   debugFlag     = false
    }


## HLT paths

  include "HLTrigger/Muon/data/PathSingleMu_2x1033_Iso.cff"
  include "HLTrigger/Muon/data/PathDiMuon_2x1033_Iso.cff"

  include "HLTrigger/Configuration/data/common/HLTSetup.cff"
  include "HLTrigger/Egamma/data/EgammaHLT.cff"
  include "HLTrigger/Egamma/data/SingleElectron.cff"
  include "HLTrigger/Egamma/data/DoubleElectron.cff"

## HWW Filter

#  include "PhysicsTools/RecoCandAlgos/data/allMuons.cfi" 
   module allMuons = MuonCloneProducer {
     InputTag src = globalMuons
   }

#  include "PhysicsTools/RecoCandAlgos/data/allElectrons.cfi"
   module allElectrons = PixelMatchGsfElectronCloneProducer {
    InputTag src = pixelMatchGsfElectrons
   }

  module allLeptons = CandMerger {
    VInputTag src = {allMuons, allElectrons}
  }

   module higgsWWFilter = HiggsToWW2LeptonsSkim
    {
      InputTag TrackLabel = allLeptons
      untracked double SingleTrackPtMin = 20.0
      untracked double DiTrackPtMin = 10.0
      untracked double etaMin = -2.4
      untracked double etaMax = 2.4
    }

   path cand = {allMuons, allElectrons, allLeptons}
   path HWWFilterPath1mu = {singleMuIso & higgsWWFilter}
   path HWWFilterPath1e  = {singleElectron & higgsWWFilter}
   path HWWFilterPath2mu = {diMuonIso & higgsWWFilter}
   path HWWFilterPath2e  = {doubleElectron & higgsWWFilter}

    include "Configuration/EventContent/data/EventContent.cff"    

    module AODSIMtot = PoolOutputModule
    {
        untracked string fileName = "/tmp/etorassa/tot_Filtered.root"
        untracked string filterName = "tot_HWWFilter"
        untracked string dataTier = "AODSIM"
        using AODSIMEventContent
	untracked PSet SelectEvents = 
	{
	    vstring SelectEvents = {"HWWFilterPath1mu","HWWFilterPath1e","HWWFilterPath2mu","HWWFilterPath2e"}
	}
    }
    module AODSIMmu = PoolOutputModule
    {
        untracked string fileName = "/tmp/etorassa/mu_Filtered.root"
        untracked string filterName = "mu_HWWFilter"
        untracked string dataTier = "AODSIM"
        using AODSIMEventContent
	untracked PSet SelectEvents = 
	{
	    vstring SelectEvents = {"HWWFilterPath1mu","HWWFilterPath2mu"}
	}
    }
    module AODSIMe = PoolOutputModule
    {
        untracked string fileName = "/tmp/etorassa/e_Filtered.root"
        untracked string filterName = "e_HWWFilter"
        untracked string dataTier = "AODSIM"
        using AODSIMEventContent
	untracked PSet SelectEvents = 
	{
	    vstring SelectEvents = {"HWWFilterPath1e","HWWFilterPath2e"}
	}
    }

   endpath outpathFull = { AODSIMtot,AODSIMmu,AODSIMe}



}
